<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <title>Quickstart - LISA API</title>
  <link href="../../img/favicon.ico" rel="icon" type="image/x-icon">
  <link rel="canonical" href="http://api.docs.lisa-project.net/tutorial/quickstart/" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="LISA, API, REST, Quickstart">
  <meta name="author" content="Julien Syx">

  <!-- Le styles -->
  <link href="../../css/prettify.css" rel="stylesheet">
  <link href="../../css/bootstrap.css" rel="stylesheet">
  <link href="../../css/bootstrap-responsive.css" rel="stylesheet">
  <link href="../../css/default.css" rel="stylesheet">

  <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <style>
    span.fusion-wrap a {
      display: block;
      margin-top: 10px;
      color: black;
    }
    a.fusion-poweredby {
      display: block;
      margin-top: 10px;
    }
    @media (max-width: 767px) {
      div.promo {
        display: none;
      }
    }
  </style>
</head>
<body onload="prettyPrint()" class="-page">

  <div class="wrapper">
        <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="repo-link btn btn-primary btn-small" href="https://github.com/project-lisa/lisa-api/tree/master">GitHub</a>
          <a class="repo-link btn btn-inverse btn-small " rel="prev" href="../1-plugins/">
            Next <i class="icon-arrow-right icon-white"></i>
          </a>
          <a class="repo-link btn btn-inverse btn-small " rel="next" href="../..">
            <i class="icon-arrow-left icon-white"></i> Previous
          </a>
          <a id="search_modal_show" class="repo-link btn btn-inverse btn-small" href="#mkdocs_search_modal" data-toggle="modal" data-target="#mkdocs_search_modal"><i class="icon-search icon-white"></i> Search</a>
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="http://www.lisa-project.net">LISA - API</a>
          <div class="nav-collapse collapse">
            
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
               
              <li >
                <a href="../..">Home</a>
              </li>
                
              <li class="dropdown active">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorial <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  
                  <li class="active" >
                    <a href="./">Quickstart</a>
                  </li>
                  
                  <li >
                    <a href="../1-plugins/">Plugins</a>
                  </li>
                  
                </ul>
              </li>
                
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Topics <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  
                  <li >
                    <a href="../../topics/internationalization/">Internationalization</a>
                  </li>
                  
                  <li >
                    <a href="../../topics/contributing/">Contributing to LISA</a>
                  </li>
                  
                </ul>
              </li>
               

            </ul>
            
          </div>
          <!--/.nav-collapse -->

        </div>
      </div>
    </div>

    <div class="body-content">
      <div class="container-fluid">
        <!-- Search Modal -->
        <div id="mkdocs_search_modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h3 id="myModalLabel">Documentation search</h3>
          </div>

          <div class="modal-body">
            <form role="form">
              <div class="form-group">
                <input type="text" name="q" class="form-control" placeholder="Search..." id="mkdocs-search-query">
              </div>
            </form>
            <div id="mkdocs-search-results"></div>
          </div>

          <div class="modal-footer">
            <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
          </div>
        </div>

        <div class="row-fluid">
          <div class="span3">
            <div id="table-of-contents">
              <ul class="nav nav-list side-nav well sidebar-nav-fixed">
                

                
                  <li class="main">
                    <a href="#quickstart">Quickstart</a>
                  </li>

                  
                    <li>
                      <a href="#docker-i-just-want-to-test">Docker - I just want to test !</a>
                    </li>
                  
                    <li>
                      <a href="#ansible-i-want-to-automatize-the-deployment">Ansible - I want to automatize the deployment</a>
                    </li>
                  
                    <li>
                      <a href="#by-hand-install-for-the-brave-and-true">By Hand - Install for the brave and true</a>
                    </li>
                  
                    <li>
                      <a href="#optionals">Optionals</a>
                    </li>
                  
                
              </ul>

            </div>
          </div>

          <div id="main-content" class="span9">
            
              

              <h1 id="quickstart">Quickstart</h1>
<h2 id="docker-i-just-want-to-test">Docker - I just want to test !</h2>
<p>It's really simple to test the API very quickly by using <a href="https://www.docker.com/">docker</a>.</p>
<p>Install <a href="https://www.docker.com/">docker</a> on your host, then launch :</p>
<pre><code class="bash">docker run  --publish=8001:8000 -d --name lisa-api seraf/lisa-api
</code></pre>

<p>Then, you can access <code>http://localhost:8001/api-auth/login/</code> (if docker is on your localhost)</p>
<p>The login and pass of this image is <code>admin</code>/<code>admin</code>.</p>
<p>You can find the docker repository <a href="https://github.com/project-lisa/lisa-api-docker">here</a></p>
<h2 id="ansible-i-want-to-automatize-the-deployment">Ansible - I want to automatize the deployment</h2>
<h3 id="ansible">Ansible</h3>
<p>You may want to have a machine to <strong>pilot</strong> all the LISA components. And it's a good idea !</p>
<p>For that, we will use <a href="http://www.ansible.com/home">Ansible</a>. A <a href="https://github.com/project-lisa/lisa-api-deployment">role has been created</a> to install the required packages to your api host.</p>
<p>You have to install Ansible. It's up to you to install the package of your linux distribution or to install it with <code>pip</code>.</p>
<h3 id="install-ansible-role">Install Ansible Role</h3>
<p>First, we will install the <a href="https://github.com/project-lisa/lisa-api-deployment">lisa-api role</a> :</p>
<pre><code class="bash">ansible-galaxy install Seraf.lisa-api
</code></pre>

<h3 id="what-is-in-the-stack">What is in the stack ?</h3>
<p>This role will deploy a stack on your server with :</p>
<ul>
<li><strong>Rabbitmq</strong> : to have a messaging server used for communication between client and api</li>
<li><strong>Python</strong> : it will install the python package of your distribution</li>
<li><strong>Virtualenv</strong> : it will create a user/group named <code>alivelisa</code> and create a virtual environment in <code>/home/alivelisa</code></li>
<li><strong>Supervisord</strong> : it is a daemon which ensure a process is always running. Instead of creating a service for LISA, supervisord will manage the process</li>
</ul>
<p>The only component you may need to install is the <code>mysql-server</code>. I did the choice to not install it as you need to setup a root account and you may want specific credentials for the <code>lisa_api</code> user.</p>
<h3 id="configure-your-ansible">Configure your Ansible</h3>
<p>For this part, you should find most of the documentation on <a href="http://www.ansible.com/home">Ansible website</a>. We will cover only the needed parts.</p>
<p>You need to tell to Ansible which host is a lisa-api.</p>
<p>For this, edit the file <code>/etc/ansible/hosts</code> :</p>
<pre><code class="ini">[lisa-api]
192.168.1.85
</code></pre>

<p>Here, my host <code>192.168.1.85</code> is a lxc container.</p>
<p>If you have no ssh key, create one :</p>
<pre><code class="bash">ssh-keygen -t rsa
</code></pre>

<p>You also need to copy your ssh key to the host to have a passwordless connection.
This command will ask you the password of the root account of the remote host :</p>
<pre><code class="bash">ssh-copy-id -i ~/.ssh/id_rsa.pub root@192.168.1.85
</code></pre>

<p>Now, you should be able to connect on your host (here <code>192.168.1.85</code>) without any password :</p>
<pre><code class="bash">ssh root@192.168.1.85
</code></pre>

<p>You can test that ansible is able to join your host :</p>
<pre><code class="bash">ansible lisa-api -m ping
</code></pre>

<h3 id="deploy-the-role-on-your-server">Deploy the role on your server</h3>
<p>Now, we need to tell to Ansible to apply the role <code>Seraf.lisa-api</code> on the group <code>lisa-api</code>.</p>
<p>Create the <a href="https://github.com/project-lisa/lisa-api/ansible/install-lisa-api.yml">playbook</a> file named <code>install-lisa-api.yml</code> :</p>
<pre><code class="yaml">---
- hosts: lisa-api
  roles:
     - Seraf.lisa-api
</code></pre>

<p>That's all ! You should be able to run it with :</p>
<pre><code class="bash">ansible-playbook install-lisa-api.yml
</code></pre>

<h3 id="create-the-configuration-file">Create the configuration file</h3>
<p>The API will read by default the configuration files located in <code>/etc/lisa/conf/lisa_api.ini</code> and <code>/home/alivelisa/.virtualenvs/lisa-api/local/lib/python2.7/site-packages/lisa_api/lisa_api.ini</code></p>
<p>An example of ini file to connect to a default database (used in docker container) :</p>
<pre><code class="ini">[api]
debug = True

[database]
name = lisa_api
user = lisa_api
password = lisapassword
host = localhost
port = 3306

[rabbitmq]
user = guest
password = guest
host = localhost
</code></pre>

<p>The api will read the configuration file in two places. One on the system <code>/etc</code> and another in the userland <code>/home</code>. It will ensure user who aren't root to be able to modify easily their configuration.</p>
<h3 id="create-the-mysql-database">Create the MySQL database</h3>
<p>As this part isn't covered by the ansible role, you need to install by yourself the mysql server and configure it.</p>
<p>You will need to create a database :</p>
<pre><code class="sql">create database lisa_api;
</code></pre>

<p>And the user associated :</p>
<pre><code class="sql">grant all privileges on lisa_api.* to 'lisa_api'@'localhost' identified by 'lisapassword';
</code></pre>

<h3 id="start-the-api">Start the API</h3>
<p>You can connect with ssh on your host to start/stop/restart the api using <code>supervisorctl</code> :</p>
<pre><code>root@lxc-lisa-api:~# supervisorctl 
lisa-api                         RUNNING    pid 1406, uptime 4:11:57
supervisor&gt; stop lisa-api
lisa-api: stopped
supervisor&gt; start lisa-api
lisa-api: started
</code></pre>

<p>Or you can use ansible to do this :</p>
<pre><code class="bash">ansible lisa-api -m supervisorctl -a &quot;name=lisa-api state=restarted&quot;
</code></pre>

<h2 id="by-hand-install-for-the-brave-and-true">By Hand - Install for the brave and true</h2>
<p>It's the best method to understand what you are doing and which components are required by the api.</p>
<p>Create a user named <code>alivelisa</code> and a group with the same name :</p>
<pre><code class="bash">sudo groupadd alivelisa
sudo useradd -m -g alivelisa alivelisa
</code></pre>

<p>Install tools for virtual environment :</p>
<pre><code>sudo pip install virtualenv virtualenvwrapper
</code></pre>

<p>Create the virtual environment :</p>
<pre><code>su - alivelisa
cd /home/alivelisa
mkvirtualenv lisa-api
workon lisa-api
</code></pre>

<p>Install using <code>pip</code>, including any optional packages you want...</p>
<pre><code>pip install lisa-api
</code></pre>
<p>...or clone the project from github.</p>
<pre><code>git clone git@github.com:project-lisa/lisa-api.git
</code></pre>
<p>Create the MySQL user</p>
<pre><code>grant all privileges on lisa_api.* to 'lisa_api'@'localhost' identified by 'lisapassword';
</code></pre>
<p>Create a configuration file</p>
<pre><code>sudo mkdir -p /etc/lisa/conf/
lisa-api-cli configuration save --filename /etc/lisa/conf/lisa_api.ini
</code></pre>
<p>You can of course edit these configuration parameters following your needs</p>
<p>Create your super-user</p>
<pre><code>lisa-api-cli createsuperuser
</code></pre>
<p>Then launch the lisa-api webserver</p>
<pre><code>lisa-api-cli runserver 0.0.0.0:8000
</code></pre>
<p>You can now access it in your browser by loging in before at <a href="http://127.0.0.1:8000/api-auth/login/">http://127.0.0.1:8000/api-auth/login/</a></p>
<pre><code>http://localhost:8000/docs/
</code></pre>
<h2 id="optionals">Optionals</h2>
<p>There is some optional packages you may need to install :</p>
<ul>
<li>If you want to use <strong>picotts</strong> : <code>libav-tools</code> <code>libttspico-data</code> <code>libttspico-utils</code> <code>libavcodec-extra-53</code></li>
</ul>
            

          </div> <!--/span-->
        </div> <!--/row-->
      </div> <!--/.fluid-container-->
    </div> <!--/.body content-->
    <div id="push"></div>
  </div> <!--/.wrapper -->

  <footer class="span12">
    <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> and using Django Rest Framework Theme.
    </p>
  </footer>

  <!-- Le javascript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="../../js/jquery-1.8.1-min.js"></script>
  <script src="../../js/prettify-1.0.js"></script>
  <script src="../../js/bootstrap-2.1.1-min.js"></script>
  <script>var base_url = '../..';</script>
  <script src="../../mkdocs/js/require.js"></script>
  <script src="../../js/theme.js"></script>

  <script>
    var shiftWindow = function() {
      scrollBy(0, -50)
    };

    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);

    $('.dropdown-menu').on('click touchstart', function(event) {
      event.stopPropagation();
    });

    // Dynamically force sidenav/dropdown to no higher than browser window
    $('.side-nav, .dropdown-menu').css('max-height', window.innerHeight - 130);

    $(function() {
      $(window).resize(function() {
        $('.side-nav, .dropdown-menu').css('max-height', window.innerHeight - 130);
      });
    });
  </script>
</body>

</html>